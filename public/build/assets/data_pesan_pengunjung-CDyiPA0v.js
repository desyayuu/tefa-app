document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".alert-dismissible").forEach(function(e){setTimeout(function(){new bootstrap.Alert(e).close()},5e3)}),p()});function p(){document.querySelectorAll('form[action*="update-pesan"]').forEach(i=>{i.addEventListener("submit",function(s){h(this)||s.preventDefault()}),i.querySelectorAll("input, textarea").forEach(s=>{s.addEventListener("input",function(){c(this)}),s.addEventListener("blur",function(){m(this)})})});const e=document.querySelector('form[action*="getPesanPengunjung"]');if(e){const i=e.querySelector('input[name="search"]');i.addEventListener("keypress",function(s){s.key==="Enter"&&e.submit()});const o=document.querySelector('a[href*="getPesanPengunjung"]:not([href*="search"])');o&&o.addEventListener("click",function(s){i.value.trim()===""&&s.preventDefault()})}document.querySelectorAll('button[data-bs-target*="modalDelete"]').forEach(i=>{i.addEventListener("click",function(){const o=this.getAttribute("data-bs-target"),s=document.querySelector(o);s&&setTimeout(()=>{const u=s.querySelector(".btn-tutup");u&&u.focus()},300)})}),document.querySelectorAll(".modal").forEach(i=>{i.addEventListener("hidden.bs.modal",function(){y(this)})}),document.querySelectorAll('input[name="telepon_pengirim"]').forEach(i=>{i.addEventListener("input",function(o){g(o.target)})}),document.querySelectorAll('input[type="email"]').forEach(i=>{i.addEventListener("blur",function(){v(this)})})}function h(t){let e=!0;return t.querySelectorAll("input[required], textarea[required]").forEach(a=>{m(a)||(e=!1)}),e}function m(t){const e=t.value.trim(),n=t.getAttribute("name");let a=!0,r="";if(t.hasAttribute("required")&&e==="")a=!1,r=`${d(n)} wajib diisi`;else if(t.type==="email"&&e!=="")/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||(a=!1,r="Format email tidak valid");else if(e!==""){const l=t.getAttribute("maxlength");l&&e.length>parseInt(l)&&(a=!1,r=`${d(n)} maksimal ${l} karakter`)}return a?c(t):f(t,r),a}function v(t){const e=t.value.trim();return e!==""&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?(f(t,"Format email tidak valid"),!1):(c(t),!0)}function d(t){return{nama_pengirim:"Nama",perusahaan_pengirim:"Perusahaan",email_pengirim:"Email",telepon_pengirim:"Telepon",pesan_pengirim:"Pesan"}[t]||"Field"}function f(t,e){t.classList.add("is-invalid"),t.classList.remove("is-valid");const n=t.parentNode.querySelector(".invalid-feedback");n&&(n.textContent=e,n.style.display="block")}function c(t){t.classList.remove("is-invalid"),t.classList.add("is-valid");const e=t.parentNode.querySelector(".invalid-feedback");e&&(e.textContent="",e.style.display="none")}function y(t){t.querySelectorAll(".form-control").forEach(a=>{a.classList.remove("is-invalid","is-valid")}),t.querySelectorAll(".invalid-feedback").forEach(a=>{a.textContent="",a.style.display="none"})}function g(t){let e=t.value.replace(/\D/g,"");e.startsWith("8")&&e.length>1&&(e="62"+e),e.startsWith("62")&&(e="+"+e),t.value=e}document.addEventListener("keydown",function(t){if((t.ctrlKey||t.metaKey)&&t.key==="f"){t.preventDefault();const e=document.querySelector('input[name="search"]');e&&(e.focus(),e.select())}if(t.key==="Escape"){const e=document.querySelector(".modal.show");if(e){const n=bootstrap.Modal.getInstance(e);n&&n.hide()}}});
