import{s as a}from"./components-C-5l6dZl.js";$(document).ready(function(){if(!document.getElementById("modalEditPortofolio")){console.log("Portfolio modal not found, skipping portfolio JavaScript initialization");return}console.log("Portfolio page detected, initializing..."),new URLSearchParams(window.location.search).get("scroll_to")==="portofolio"&&setTimeout(function(){const e=document.getElementById("section-portofolio");e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),console.log("Auto-scrolled to portfolio section"))},500);let l;setTimeout(function(){try{const e=document.getElementById("modalEditPortofolio");console.log("Modal element found:",e),e&&typeof bootstrap<"u"?(l=new bootstrap.Modal(e,{backdrop:"static",keyboard:!1}),console.log("Bootstrap modal initialized:",l)):(console.warn("Bootstrap not available or modal element not found"),l=null)}catch(e){console.error("Bootstrap modal initialization failed:",e),l=null}},100),$(document).on("click",".btn-edit",function(e){e.preventDefault(),e.stopPropagation();const o=$(this).data("id");if(console.log("Edit button clicked, ID:",o),console.log("Button element:",this),!o){console.error("ID tidak ditemukan"),a.errorMessage("ID tidak ditemukan");return}const s=`/koordinator/data-mahasiswa/portofolio/detail/${o}`;console.log("Making request to:",s),$.ajax({url:s,type:"GET",beforeSend:function(){console.log("Loading edit data...")},success:function(t){if(console.log("Edit data response:",t),t.status==="success"){const r=t.data;console.log("Portfolio data:",r);const n=$("#modalEditPortofolio");if(console.log("Modal element check:",n.length),n.length===0){console.error("Modal element not found in DOM"),a.errorMessage("Modal tidak ditemukan");return}$("#formEditPortofolio")[0].reset(),$("#edit_id").val(r.portofolio_id),$("#edit_nama_kegiatan").val(r.nama_kegiatan),$("#edit_jenis_kegiatan").val(r.jenis_kegiatan),$("#edit_penyelenggara").val(r.penyelenggara||""),$("#edit_tingkat_kegiatan").val(r.tingkat_kegiatan),$("#edit_peran_dalam_kegiatan").val(r.peran_dalam_kegiatan||""),$("#edit_link_kegiatan").val(r.link_kegiatan||""),$("#edit_deskripsi_kegiatan").val(r.deskripsi_kegiatan||""),console.log("Form populated with data");const i=`/koordinator/data-mahasiswa/portofolio/update/${o}`;$("#formEditPortofolio").attr("action",i),console.log("Form action set to:",i),console.log("Attempting to show modal...");let d=!1;if(l&&!d)try{console.log("Trying bootstrap modal.show()"),l.show(),d=!0,console.log("Modal shown via bootstrap API")}catch(c){console.error("Bootstrap modal show error:",c)}if(!d)try{console.log("Trying jQuery modal show"),n.modal("show"),d=!0,console.log("Modal shown via jQuery")}catch(c){console.error("jQuery modal show error:",c)}if(!d)try{console.log("Trying manual modal show"),n.addClass("show").css({display:"block","padding-right":"17px"}),$("body").addClass("modal-open").css("padding-right","17px"),$(".modal-backdrop").remove(),$('<div class="modal-backdrop fade show"></div>').appendTo("body"),d=!0,console.log("Modal shown manually")}catch(c){console.error("Manual modal show error:",c)}d||(console.error("All modal show methods failed"),a.errorMessage("Gagal menampilkan modal edit"))}else console.error("Response error:",t.message),a.errorMessage("Error: "+t.message)},error:function(t,r,n){console.error("AJAX Error details:",{xhr:t,status:r,error:n,responseText:t.responseText,statusCode:t.status});let i="Error loading data";t.responseJSON&&t.responseJSON.message?i=t.responseJSON.message:t.status===404?i="Data tidak ditemukan":t.status===500?i="Server error":t.status===0&&(i="Network error atau route tidak ditemukan"),a.errorMessage(i)}})}),$(document).on("click",".btn-delete",function(e){e.preventDefault(),e.stopPropagation();const o=$(this).data("id");if(console.log("Delete button clicked, ID:",o),!o){a.errorMessage("ID tidak ditemukan");return}a.confirmationDelete("Apakah Anda yakin ingin menghapus data portofolio ini?").then(s=>{s.isConfirmed&&u(o)})});function u(e){$.ajax({url:`/koordinator/data-mahasiswa/portofolio/delete/${e}`,type:"DELETE",data:{_token:$('meta[name="csrf-token"]').attr("content")},beforeSend:function(){console.log("Deleting data...")},success:function(o){console.log("Delete response:",o),o.status==="success"?(a.successMessage("Data portofolio berhasil dihapus"),setTimeout(()=>{const s=new URL(window.location);s.searchParams.set("scroll_to","portofolio"),window.location.href=s.toString()},1500)):a.errorMessage(o.message)},error:function(o,s,t){console.error("Error deleting data:",o),a.errorMessage("Error deleting data: "+(o.responseJSON?o.responseJSON.message:t))}})}$(document).on("click",'[data-bs-dismiss="modal"]',function(){$(this).closest(".modal").attr("id")==="modalEditPortofolio"&&m()});function m(){try{l?l.hide():$("#modalEditPortofolio").modal("hide")}catch{console.log("Manual modal close"),$("#modalEditPortofolio").removeClass("show").css("display","none"),$("body").removeClass("modal-open").css("padding-right",""),$(".modal-backdrop").remove()}}$("#formTambahPortofolio").on("submit",function(e){e.preventDefault(),console.log("Form tambah submitted"),$.ajax({url:$(this).attr("action"),type:"POST",data:$(this).serialize(),beforeSend:function(){console.log("Saving new data...")},success:function(o){console.log("Save response:",o),o.status==="success"?($("#modalTambahPortofolio").modal("hide"),a.successMessage("Data portofolio berhasil ditambahkan"),setTimeout(()=>{const s=new URL(window.location);s.searchParams.set("scroll_to","portofolio"),window.location.href=s.toString()},1500)):a.errorMessage(o.message)},error:function(o,s,t){if(console.error("Error saving data:",o),o.status===422){const r=o.responseJSON.errors;let n=`Validation Error:
`;for(let i in r)n+="- "+r[i][0]+`
`;a.errorMessage(n)}else a.errorMessage("Error saving data: "+t)}})}),$("#formEditPortofolio").on("submit",function(e){e.preventDefault(),console.log("Form edit submitted"),console.log("Form action:",$(this).attr("action")),$.ajax({url:$(this).attr("action"),type:"POST",data:$(this).serialize(),beforeSend:function(){console.log("Updating data...")},success:function(o){console.log("Update response:",o),o.status==="success"?(m(),a.successMessage("Data portofolio berhasil diperbarui"),setTimeout(()=>{const s=new URL(window.location);s.searchParams.set("scroll_to","portofolio"),window.location.href=s.toString()},1500)):a.errorMessage(o.message)},error:function(o,s,t){if(console.error("Error updating data:",o),o.status===422){const r=o.responseJSON.errors;let n=`Validation Error:
`;for(let i in r)n+="- "+r[i][0]+`
`;a.errorMessage(n)}else a.errorMessage("Error updating data: "+t)}})}),$("#modalTambahPortofolio").on("hidden.bs.modal",function(){$("#formTambahPortofolio")[0].reset()}),$("#modalEditPortofolio").on("hidden.bs.modal",function(){$("#formEditPortofolio")[0].reset()})});
